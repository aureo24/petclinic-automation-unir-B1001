{"version":3,"file":"labels.js","names":["hostname","env","pid","isMainThread","threadId","LabelName","ENV_LABEL_PREFIX","getEnvironmentLabels","result","envKey","startsWith","name","substring","length","trim","push","value","process","hostValue","getHostLabel","_env$ALLURE_HOST_NAME","ALLURE_HOST_NAME","HOST","getThreadLabel","userProvidedThreadId","_ref","_env$ALLURE_THREAD_NA","THREAD","ALLURE_THREAD_NAME","concat","toString"],"sources":["../../../../../src/sdk/reporter/utils/labels.ts"],"sourcesContent":["import { hostname } from \"node:os\";\nimport { env, pid } from \"node:process\";\nimport { isMainThread, threadId } from \"node:worker_threads\";\nimport type { Label } from \"../../../model.js\";\nimport { LabelName } from \"../../../model.js\";\n\nconst ENV_LABEL_PREFIX = \"ALLURE_LABEL_\";\n\nexport const getEnvironmentLabels = (): Label[] => {\n  const result: Label[] = [];\n  for (const envKey in env) {\n    if (envKey.startsWith(ENV_LABEL_PREFIX)) {\n      const name = envKey.substring(ENV_LABEL_PREFIX.length).trim();\n      if (name !== \"\") {\n        result.push({ name, value: process.env[envKey]! });\n      }\n    }\n  }\n  return result;\n};\n\nlet hostValue: string;\n\nexport const getHostLabel = (): Label => {\n  if (!hostValue) {\n    hostValue = env.ALLURE_HOST_NAME ?? hostname();\n  }\n\n  return {\n    name: LabelName.HOST,\n    value: hostValue,\n  };\n};\n\nexport const getThreadLabel = (userProvidedThreadId?: string): Label => {\n  return {\n    name: LabelName.THREAD,\n    value:\n      env.ALLURE_THREAD_NAME ??\n      userProvidedThreadId ??\n      `pid-${pid.toString()}-worker-${isMainThread ? \"main\" : threadId}`,\n  };\n};\n"],"mappings":"AAAA,SAASA,QAAQ,QAAQ,SAAS;AAClC,SAASC,GAAG,EAAEC,GAAG,QAAQ,cAAc;AACvC,SAASC,YAAY,EAAEC,QAAQ,QAAQ,qBAAqB;AAE5D,SAASC,SAAS,QAAQ,mBAAmB;AAE7C,IAAMC,gBAAgB,GAAG,eAAe;AAExC,OAAO,IAAMC,oBAAoB,GAAGA,CAAA,KAAe;EACjD,IAAMC,MAAe,GAAG,EAAE;EAC1B,KAAK,IAAMC,MAAM,IAAIR,GAAG,EAAE;IACxB,IAAIQ,MAAM,CAACC,UAAU,CAACJ,gBAAgB,CAAC,EAAE;MACvC,IAAMK,IAAI,GAAGF,MAAM,CAACG,SAAS,CAACN,gBAAgB,CAACO,MAAM,CAAC,CAACC,IAAI,CAAC,CAAC;MAC7D,IAAIH,IAAI,KAAK,EAAE,EAAE;QACfH,MAAM,CAACO,IAAI,CAAC;UAAEJ,IAAI;UAAEK,KAAK,EAAEC,OAAO,CAAChB,GAAG,CAACQ,MAAM;QAAG,CAAC,CAAC;MACpD;IACF;EACF;EACA,OAAOD,MAAM;AACf,CAAC;AAED,IAAIU,SAAiB;AAErB,OAAO,IAAMC,YAAY,GAAGA,CAAA,KAAa;EACvC,IAAI,CAACD,SAAS,EAAE;IAAA,IAAAE,qBAAA;IACdF,SAAS,IAAAE,qBAAA,GAAGnB,GAAG,CAACoB,gBAAgB,cAAAD,qBAAA,cAAAA,qBAAA,GAAIpB,QAAQ,CAAC,CAAC;EAChD;EAEA,OAAO;IACLW,IAAI,EAAEN,SAAS,CAACiB,IAAI;IACpBN,KAAK,EAAEE;EACT,CAAC;AACH,CAAC;AAED,OAAO,IAAMK,cAAc,GAAIC,oBAA6B,IAAY;EAAA,IAAAC,IAAA,EAAAC,qBAAA;EACtE,OAAO;IACLf,IAAI,EAAEN,SAAS,CAACsB,MAAM;IACtBX,KAAK,GAAAS,IAAA,IAAAC,qBAAA,GACHzB,GAAG,CAAC2B,kBAAkB,cAAAF,qBAAA,cAAAA,qBAAA,GACtBF,oBAAoB,cAAAC,IAAA,cAAAA,IAAA,UAAAI,MAAA,CACb3B,GAAG,CAAC4B,QAAQ,CAAC,CAAC,cAAAD,MAAA,CAAW1B,YAAY,GAAG,MAAM,GAAGC,QAAQ;EACpE,CAAC;AACH,CAAC","ignoreList":[]}