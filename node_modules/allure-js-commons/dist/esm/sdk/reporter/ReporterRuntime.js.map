{"version":3,"file":"ReporterRuntime.js","names":["extname","Stage","LifecycleState","Notifier","createFixtureResult","createStepResult","createTestResult","hasSkipLabel","deepClone","formatLinks","getTestResultHistoryId","getTestResultTestCaseId","randomUuid","buildAttachmentFileName","resolveWriter","DefaultStepStack","constructor","_defineProperty","Map","stepsByRoot","clear","rootsByStep","rootUuid","maybeValue","get","delete","forEach","stepUuid","length","set","push","removeStep","newValue","filter","value","_handleMetadataMessage","WeakMap","_handleStepMetadataMessage","_handleStartStepMessage","_handleStopStepMessage","_handleAttachmentContentMessage","_handleAttachmentPathMessage","_findParent","_writeFixturesOfScope","_writeContainer","_calculateTimings","ReporterRuntime","_ref","_this","writer","listeners","environmentInfo","categories","links","uuid","state","setScope","updateFunc","scope","getScope","console","error","concat","_classPrivateFieldGet","call","deleteScope","scopeUuid","type","fixtureResult","wrappedFixture","setFixtureResult","_objectSpread","start","Date","now","fixtures","fixture","getFixtureResult","opts","startStop","stop","duration","stage","FINISHED","result","scopeUuids","arguments","undefined","testResult","notifier","beforeTestResultStart","tests","setTestResult","afterTestResultStart","getTestResult","beforeTestResultUpdate","afterTestResultUpdate","_testResult$testCaseI","_testResult$historyId","beforeTestResultStop","testCaseId","historyId","afterTestResultStop","testResults","labels","deleteTestResult","beforeTestResultWrite","writeResult","afterTestResultWrite","stepStack","currentStep","parentStepUuid","parent","JSON","stringify","stepResult","steps","setStepResult","addStep","step","getStepResult","beforeStepStop","afterStepStop","attachmentName","attachmentContentOrPath","options","_options$fileExtensio","isPath","fileExtension","attachmentFileName","contentType","writeAttachmentFromPath","writeAttachment","attachment","name","source","wrapInStep","timestamp","attachments","writeEnvironmentInfo","serializedCategories","map","c","messageRegex","RegExp","traceRegex","writeCategoriesDefinitions","messages","message","data","_classPrivateFieldInitSpec","updateFixture","displayName","parameters","rest","_objectWithoutProperties","_excluded","updateTest","linkConfig","Object","assign","updateStep","startStep","status","statusDetails","stopStep","Buffer","from","content","encoding","path","root","getExecutionItem","_ref2","writtenFixtures","Set","has","deleteFixtureResult","add","befores","afters","writeGroup","children","normalisedDuration","Math","max"],"sources":["../../../../src/sdk/reporter/ReporterRuntime.ts"],"sourcesContent":["/* eslint max-lines: 0 */\nimport { extname } from \"path\";\nimport {\n  type Attachment,\n  type AttachmentOptions,\n  type FixtureResult,\n  Stage,\n  type StepResult,\n  type TestResult,\n} from \"../../model.js\";\nimport type {\n  Category,\n  EnvironmentInfo,\n  RuntimeAttachmentContentMessage,\n  RuntimeAttachmentPathMessage,\n  RuntimeMessage,\n  RuntimeMetadataMessage,\n  RuntimeStartStepMessage,\n  RuntimeStepMetadataMessage,\n  RuntimeStopStepMessage,\n} from \"../types.js\";\nimport { LifecycleState } from \"./LifecycleState.js\";\nimport { Notifier } from \"./Notifier.js\";\nimport { createFixtureResult, createStepResult, createTestResult } from \"./factory.js\";\nimport { hasSkipLabel } from \"./testplan.js\";\nimport type { FixtureType, FixtureWrapper, LinkConfig, ReporterRuntimeConfig, TestScope, Writer } from \"./types.js\";\nimport { deepClone, formatLinks, getTestResultHistoryId, getTestResultTestCaseId, randomUuid } from \"./utils.js\";\nimport { buildAttachmentFileName } from \"./utils/attachments.js\";\nimport { resolveWriter } from \"./writer/loader.js\";\n\ninterface StepStack {\n  clear(): void;\n\n  removeRoot(rootUuid: string): void;\n\n  currentStep(rootUuid: string): string | undefined;\n\n  addStep(rootUuid: string, stepUuid: string): void;\n\n  removeStep(stepUuid: string): void;\n}\n\nclass DefaultStepStack implements StepStack {\n  private stepsByRoot: Map<string, string[]> = new Map();\n  private rootsByStep: Map<string, string> = new Map();\n\n  clear = (): void => {\n    this.stepsByRoot.clear();\n    this.rootsByStep.clear();\n  };\n\n  removeRoot = (rootUuid: string): void => {\n    const maybeValue = this.stepsByRoot.get(rootUuid);\n    this.stepsByRoot.delete(rootUuid);\n    if (maybeValue) {\n      maybeValue.forEach((stepUuid) => this.rootsByStep.delete(stepUuid));\n    }\n  };\n\n  currentStep = (rootUuid: string): string | undefined => {\n    const maybeValue = this.stepsByRoot.get(rootUuid);\n    if (!maybeValue) {\n      return;\n    }\n    return maybeValue[maybeValue.length - 1];\n  };\n\n  addStep = (rootUuid: string, stepUuid: string): void => {\n    const maybeValue = this.stepsByRoot.get(rootUuid);\n    if (!maybeValue) {\n      this.stepsByRoot.set(rootUuid, [stepUuid]);\n    } else {\n      maybeValue.push(stepUuid);\n    }\n    this.rootsByStep.set(stepUuid, rootUuid);\n  };\n\n  removeStep(stepUuid: string) {\n    const rootUuid = this.rootsByStep.get(stepUuid);\n    if (!rootUuid) {\n      return;\n    }\n    const maybeValue = this.stepsByRoot.get(rootUuid);\n    if (!maybeValue) {\n      return;\n    }\n    const newValue = maybeValue.filter((value) => value !== stepUuid);\n    this.stepsByRoot.set(rootUuid, newValue);\n  }\n}\n\nexport class ReporterRuntime {\n  private readonly state = new LifecycleState();\n  private notifier: Notifier;\n  private stepStack: StepStack = new DefaultStepStack();\n  writer: Writer;\n  categories?: Category[];\n  environmentInfo?: EnvironmentInfo;\n  linkConfig?: LinkConfig;\n\n  constructor({ writer, listeners = [], environmentInfo, categories, links }: ReporterRuntimeConfig) {\n    this.writer = resolveWriter(writer);\n    this.notifier = new Notifier({ listeners });\n    this.categories = categories;\n    this.environmentInfo = environmentInfo;\n    this.linkConfig = links;\n  }\n\n  startScope = (): string => {\n    const uuid = randomUuid();\n    this.state.setScope(uuid);\n    return uuid;\n  };\n\n  updateScope = (uuid: string, updateFunc: (scope: TestScope) => void): void => {\n    const scope = this.state.getScope(uuid);\n    if (!scope) {\n      // eslint-disable-next-line no-console\n      console.error(`count not update scope: no scope with uuid ${uuid} is found`);\n      return;\n    }\n\n    updateFunc(scope);\n  };\n\n  writeScope = (uuid: string) => {\n    const scope = this.state.getScope(uuid);\n    if (!scope) {\n      // eslint-disable-next-line no-console\n      console.error(`count not write scope: no scope with uuid ${uuid} is found`);\n      return;\n    }\n\n    this.#writeFixturesOfScope(scope);\n    this.state.deleteScope(scope.uuid);\n  };\n\n  startFixture = (scopeUuid: string, type: FixtureType, fixtureResult: Partial<FixtureResult>): string | undefined => {\n    const scope = this.state.getScope(scopeUuid);\n    if (!scope) {\n      // eslint-disable-next-line no-console\n      console.error(`count not start fixture: no scope with uuid ${scopeUuid} is found`);\n      return;\n    }\n\n    const uuid = randomUuid();\n    const wrappedFixture = this.state.setFixtureResult(uuid, type, {\n      ...createFixtureResult(),\n      start: Date.now(),\n      ...fixtureResult,\n    });\n\n    scope.fixtures.push(wrappedFixture);\n    return uuid;\n  };\n\n  updateFixture = (uuid: string, updateFunc: (result: FixtureResult) => void): void => {\n    const fixture = this.state.getFixtureResult(uuid);\n\n    if (!fixture) {\n      // eslint-disable-next-line no-console\n      console.error(`could not update fixture: no fixture with uuid ${uuid} is found`);\n      return;\n    }\n\n    updateFunc(fixture);\n  };\n\n  stopFixture = (uuid: string, opts?: { stop?: number; duration?: number }): void => {\n    const fixture = this.state.getFixtureResult(uuid);\n    if (!fixture) {\n      // eslint-disable-next-line no-console\n      console.error(`could not stop fixture: no fixture with uuid ${uuid} is found`);\n      return;\n    }\n\n    const startStop = this.#calculateTimings(fixture.start, opts?.stop, opts?.duration);\n    fixture.start = startStop.start;\n    fixture.stop = startStop.stop;\n\n    fixture.stage = Stage.FINISHED;\n  };\n\n  startTest = (result: Partial<TestResult>, scopeUuids: string[] = []): string => {\n    const uuid = randomUuid();\n    const testResult: TestResult = {\n      ...createTestResult(uuid),\n      start: Date.now(),\n      ...deepClone(result),\n    };\n\n    this.notifier.beforeTestResultStart(testResult);\n\n    scopeUuids.forEach((scopeUuid) => {\n      const scope = this.state.getScope(scopeUuid);\n      if (!scope) {\n        // eslint-disable-next-line no-console\n        console.error(`count not link test to the scope: no scope with uuid ${uuid} is found`);\n        return;\n      }\n      scope.tests.push(uuid);\n    });\n\n    this.state.setTestResult(uuid, testResult);\n    this.notifier.afterTestResultStart(testResult);\n    return uuid;\n  };\n\n  updateTest = (uuid: string, updateFunc: (result: TestResult) => void): void => {\n    const testResult = this.state.getTestResult(uuid);\n\n    if (!testResult) {\n      // eslint-disable-next-line no-console\n      console.error(`could not update test result: no test with uuid ${uuid}) is found`);\n      return;\n    }\n\n    this.notifier.beforeTestResultUpdate(testResult);\n    updateFunc(testResult);\n    this.notifier.afterTestResultUpdate(testResult);\n  };\n\n  stopTest = (uuid: string, opts?: { stop?: number; duration?: number }) => {\n    const testResult = this.state.getTestResult(uuid);\n    if (!testResult) {\n      // eslint-disable-next-line no-console\n      console.error(`could not stop test result: no test with uuid ${uuid}) is found`);\n      return;\n    }\n\n    this.notifier.beforeTestResultStop(testResult);\n    testResult.testCaseId ??= getTestResultTestCaseId(testResult);\n    testResult.historyId ??= getTestResultHistoryId(testResult);\n\n    const startStop = this.#calculateTimings(testResult.start, opts?.stop, opts?.duration);\n    testResult.start = startStop.start;\n    testResult.stop = startStop.stop;\n\n    this.notifier.afterTestResultStop(testResult);\n  };\n\n  writeTest = (uuid: string) => {\n    const testResult = this.state.testResults.get(uuid);\n    if (!testResult) {\n      // eslint-disable-next-line no-console\n      console.error(`could not write test result: no test with uuid ${uuid} is found`);\n      return;\n    }\n\n    if (hasSkipLabel(testResult.labels)) {\n      this.state.deleteTestResult(uuid);\n      return;\n    }\n\n    this.notifier.beforeTestResultWrite(testResult);\n\n    this.writer.writeResult(testResult);\n    this.state.deleteTestResult(uuid);\n\n    this.notifier.afterTestResultWrite(testResult);\n  };\n\n  currentStep = (rootUuid: string): string | undefined => {\n    return this.stepStack.currentStep(rootUuid);\n  };\n\n  startStep = (\n    rootUuid: string,\n    parentStepUuid: string | null | undefined,\n    result: Partial<StepResult>,\n  ): string | undefined => {\n    const parent = this.#findParent(rootUuid, parentStepUuid);\n    if (!parent) {\n      // eslint-disable-next-line no-console\n      console.error(\n        `could not start test step: no context for root ${rootUuid} and parentStepUuid ${JSON.stringify(parentStepUuid)} is found`,\n      );\n      return;\n    }\n    const stepResult: StepResult = {\n      ...createStepResult(),\n      start: Date.now(),\n      ...result,\n    };\n    parent.steps.push(stepResult);\n    const stepUuid = randomUuid();\n    this.state.setStepResult(stepUuid, stepResult);\n\n    this.stepStack.addStep(rootUuid, stepUuid);\n\n    return stepUuid;\n  };\n\n  updateStep = (uuid: string, updateFunc: (stepResult: StepResult) => void) => {\n    const step = this.state.getStepResult(uuid)!;\n    if (!step) {\n      // eslint-disable-next-line no-console\n      console.error(`could not update test step: no step with uuid ${uuid} is found`);\n      return;\n    }\n\n    updateFunc(step);\n  };\n\n  stopStep = (uuid: string, opts?: { stop?: number; duration?: number }) => {\n    const step = this.state.getStepResult(uuid);\n    if (!step) {\n      // eslint-disable-next-line no-console\n      console.error(`could not stop test step: no step with uuid ${uuid} is found`);\n      return;\n    }\n\n    this.notifier.beforeStepStop(step);\n\n    const startStop = this.#calculateTimings(step.start, opts?.stop, opts?.duration);\n    step.start = startStop.start;\n    step.stop = startStop.stop;\n\n    step.stage = Stage.FINISHED;\n\n    this.stepStack.removeStep(uuid);\n\n    this.notifier.afterStepStop(step);\n  };\n\n  writeAttachment = (\n    rootUuid: string,\n    parentStepUuid: string | null | undefined,\n    attachmentName: string,\n    attachmentContentOrPath: Buffer | string,\n    options: AttachmentOptions & { wrapInStep?: boolean; timestamp?: number },\n  ) => {\n    const parent = this.#findParent(rootUuid, parentStepUuid);\n    if (!parent) {\n      // eslint-disable-next-line no-console\n      console.error(\n        `could not write test attachment: no context for root ${rootUuid} and parentStepUuid ${JSON.stringify(parentStepUuid)} is found`,\n      );\n      return;\n    }\n\n    const isPath = typeof attachmentContentOrPath === \"string\";\n    const fileExtension = options.fileExtension ?? (isPath ? extname(attachmentContentOrPath) : undefined);\n    const attachmentFileName = buildAttachmentFileName({\n      contentType: options.contentType,\n      fileExtension,\n    });\n\n    if (isPath) {\n      this.writer.writeAttachmentFromPath(attachmentFileName, attachmentContentOrPath);\n    } else {\n      this.writer.writeAttachment(attachmentFileName, attachmentContentOrPath);\n    }\n\n    const attachment: Attachment = {\n      name: attachmentName,\n      source: attachmentFileName,\n      type: options.contentType,\n    };\n\n    if (options.wrapInStep) {\n      const { timestamp = Date.now() } = options;\n      parent.steps.push({\n        name: attachmentName,\n        attachments: [attachment],\n        start: timestamp,\n        stop: timestamp,\n      } as StepResult);\n    } else {\n      parent.attachments.push(attachment);\n    }\n  };\n\n  writeEnvironmentInfo = () => {\n    if (!this.environmentInfo) {\n      return;\n    }\n\n    this.writer.writeEnvironmentInfo(this.environmentInfo);\n  };\n\n  writeCategoriesDefinitions = () => {\n    if (!this.categories) {\n      return;\n    }\n\n    const serializedCategories = this.categories.map((c) => {\n      if (c.messageRegex instanceof RegExp) {\n        c.messageRegex = c.messageRegex.source;\n      }\n\n      if (c.traceRegex instanceof RegExp) {\n        c.traceRegex = c.traceRegex.source;\n      }\n\n      return c;\n    });\n\n    this.writer.writeCategoriesDefinitions(serializedCategories);\n  };\n\n  applyRuntimeMessages = (rootUuid: string, messages: RuntimeMessage[]) => {\n    messages.forEach((message) => {\n      switch (message.type) {\n        case \"metadata\":\n          this.#handleMetadataMessage(rootUuid, message.data);\n          return;\n        case \"step_metadata\":\n          this.#handleStepMetadataMessage(rootUuid, message.data);\n          return;\n        case \"step_start\":\n          this.#handleStartStepMessage(rootUuid, message.data);\n          return;\n        case \"step_stop\":\n          this.#handleStopStepMessage(rootUuid, message.data);\n          return;\n        case \"attachment_content\":\n          this.#handleAttachmentContentMessage(rootUuid, message.data);\n          return;\n        case \"attachment_path\":\n          this.#handleAttachmentPathMessage(rootUuid, message.data);\n          return;\n        default:\n          // eslint-disable-next-line no-console\n          console.error(`could not apply runtime messages: unknown message ${JSON.stringify(message)}`);\n          return;\n      }\n    });\n  };\n\n  #handleMetadataMessage = (rootUuid: string, message: RuntimeMetadataMessage[\"data\"]) => {\n    // only display name could be set to fixture.\n    const fixtureResult = this.state.getFixtureResult(rootUuid);\n    if (fixtureResult) {\n      this.updateFixture(rootUuid, (result) => {\n        if (message.displayName) {\n          result.name = message.displayName;\n        }\n      });\n      return;\n    }\n\n    const { links, labels, parameters, displayName, ...rest } = message;\n    this.updateTest(rootUuid, (result) => {\n      if (links) {\n        result.links = [...result.links, ...(this.linkConfig ? formatLinks(this.linkConfig, links) : links)];\n      }\n      if (labels) {\n        result.labels = [...result.labels, ...labels];\n      }\n      if (parameters) {\n        result.parameters = [...result.parameters, ...parameters];\n      }\n      if (displayName) {\n        result.name = displayName;\n      }\n      Object.assign(result, rest);\n    });\n  };\n\n  #handleStepMetadataMessage = (rootUuid: string, message: RuntimeStepMetadataMessage[\"data\"]) => {\n    const stepUuid = this.currentStep(rootUuid);\n    if (!stepUuid) {\n      // eslint-disable-next-line no-console\n      console.error(\"could not handle step metadata message: no step is running\");\n      return;\n    }\n    const { name, parameters } = message;\n    this.updateStep(stepUuid, (stepResult) => {\n      if (name) {\n        stepResult.name = name;\n      }\n      if (parameters) {\n        stepResult.parameters = [...stepResult.parameters, ...parameters];\n      }\n    });\n  };\n\n  #handleStartStepMessage = (rootUuid: string, message: RuntimeStartStepMessage[\"data\"]) => {\n    this.startStep(rootUuid, undefined, { ...message });\n  };\n\n  #handleStopStepMessage = (rootUuid: string, message: RuntimeStopStepMessage[\"data\"]) => {\n    const stepUuid = this.currentStep(rootUuid);\n    if (!stepUuid) {\n      // eslint-disable-next-line no-console\n      console.error(\"could not handle step stop message: no step is running\");\n      return;\n    }\n    this.updateStep(stepUuid, (result) => {\n      if (message.status && !result.status) {\n        result.status = message.status;\n      }\n      if (message.statusDetails) {\n        result.statusDetails = { ...result.statusDetails, ...message.statusDetails };\n      }\n    });\n    this.stopStep(stepUuid, { stop: message.stop });\n  };\n\n  #handleAttachmentContentMessage = (rootUuid: string, message: RuntimeAttachmentContentMessage[\"data\"]) => {\n    this.writeAttachment(rootUuid, undefined, message.name, Buffer.from(message.content, message.encoding), {\n      encoding: message.encoding,\n      contentType: message.contentType,\n      fileExtension: message.fileExtension,\n      wrapInStep: message.wrapInStep,\n      timestamp: message.timestamp,\n    });\n  };\n\n  #handleAttachmentPathMessage = (rootUuid: string, message: RuntimeAttachmentPathMessage[\"data\"]) => {\n    this.writeAttachment(rootUuid, undefined, message.name, message.path, {\n      contentType: message.contentType,\n      fileExtension: message.fileExtension,\n      wrapInStep: message.wrapInStep,\n      timestamp: message.timestamp,\n    });\n  };\n\n  #findParent = (\n    rootUuid: string,\n    parentStepUuid: string | null | undefined,\n  ): FixtureResult | TestResult | StepResult | undefined => {\n    const root = this.state.getExecutionItem(rootUuid);\n    if (!root) {\n      return;\n    }\n\n    if (parentStepUuid === null) {\n      return root;\n    } else if (parentStepUuid === undefined) {\n      const stepUuid = this.currentStep(rootUuid);\n      return stepUuid ? this.state.getStepResult(stepUuid) : root;\n    } else {\n      return this.state.getStepResult(parentStepUuid);\n    }\n  };\n\n  #writeFixturesOfScope = ({ fixtures, tests }: TestScope) => {\n    const writtenFixtures = new Set<string>();\n    if (tests.length) {\n      for (const wrappedFixture of fixtures) {\n        if (!writtenFixtures.has(wrappedFixture.uuid)) {\n          this.#writeContainer(tests, wrappedFixture);\n          this.state.deleteFixtureResult(wrappedFixture.uuid);\n          writtenFixtures.add(wrappedFixture.uuid);\n        }\n      }\n    }\n  };\n\n  #writeContainer = (tests: string[], wrappedFixture: FixtureWrapper) => {\n    const fixture = wrappedFixture.value;\n    const befores = wrappedFixture.type === \"before\" ? [wrappedFixture.value] : [];\n    const afters = wrappedFixture.type === \"after\" ? [wrappedFixture.value] : [];\n    this.writer.writeGroup({\n      uuid: wrappedFixture.uuid,\n      name: fixture.name,\n      children: [...new Set(tests)],\n      befores,\n      afters,\n    });\n  };\n\n  #calculateTimings = (start?: number, stop?: number, duration?: number): { start?: number; stop?: number } => {\n    const result: { start?: number; stop?: number } = { start, stop };\n    if (duration) {\n      const normalisedDuration = Math.max(0, duration);\n      if (result.stop !== undefined) {\n        result.start = result.stop - normalisedDuration;\n      } else if (result.start !== undefined) {\n        result.stop = result.start + normalisedDuration;\n      } else {\n        result.stop = Date.now();\n        result.start = result.stop - normalisedDuration;\n      }\n    } else {\n      if (result.stop === undefined) {\n        result.stop = Date.now();\n      }\n      if (result.start === undefined) {\n        result.start = result.stop;\n      }\n    }\n    return result;\n  };\n}\n"],"mappings":"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","ignoreList":[]}